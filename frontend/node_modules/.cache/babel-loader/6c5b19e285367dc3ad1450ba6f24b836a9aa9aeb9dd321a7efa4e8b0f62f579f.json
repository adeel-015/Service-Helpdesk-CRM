{"ast":null,"code":"import React from'react';import{useNavigate}from'react-router-dom';import{Eye,Trash2}from'lucide-react';import StatusBadge from'../common/StatusBadge';import PriorityBadge from'../common/PriorityBadge';import EmptyState from'../common/EmptyState';import{useAuth}from'../../contexts/AuthContext';import toast from'react-hot-toast';import{jsx as _jsx,jsxs as _jsxs}from\"react/jsx-runtime\";const TicketTable=_ref=>{let{tickets,onDelete,onAssign,agents=[]}=_ref;const navigate=useNavigate();const{isAdmin,isAgent,user}=useAuth();const handleDelete=async(id,title)=>{if(window.confirm(\"Are you sure you want to delete \\\"\".concat(title,\"\\\"?\"))){try{await onDelete(id);toast.success('Ticket deleted successfully');}catch(error){toast.error(error.message||'Failed to delete ticket');}}};const handleAssign=async(ticketId,agentId)=>{try{await onAssign(ticketId,agentId);toast.success('Ticket assigned successfully');}catch(error){toast.error(error.message||'Failed to assign ticket');}};if(!tickets||tickets.length===0){return/*#__PURE__*/_jsx(EmptyState,{icon:()=>/*#__PURE__*/_jsx(\"div\",{className:\"text-6xl\",children:\"\\uD83D\\uDCCB\"}),title:\"No tickets found\",description:\"There are no tickets to display.\"});}return/*#__PURE__*/_jsx(\"div\",{className:\"overflow-x-auto\",children:/*#__PURE__*/_jsxs(\"table\",{className:\"min-w-full bg-white border border-gray-200 rounded-lg\",children:[/*#__PURE__*/_jsx(\"thead\",{className:\"bg-gray-50\",children:/*#__PURE__*/_jsxs(\"tr\",{children:[/*#__PURE__*/_jsx(\"th\",{className:\"px-4 py-3 text-left text-xs font-medium text-gray-500 uppercase tracking-wider\",children:\"ID\"}),/*#__PURE__*/_jsx(\"th\",{className:\"px-4 py-3 text-left text-xs font-medium text-gray-500 uppercase tracking-wider\",children:\"Title\"}),/*#__PURE__*/_jsx(\"th\",{className:\"px-4 py-3 text-left text-xs font-medium text-gray-500 uppercase tracking-wider\",children:\"Status\"}),/*#__PURE__*/_jsx(\"th\",{className:\"px-4 py-3 text-left text-xs font-medium text-gray-500 uppercase tracking-wider\",children:\"Priority\"}),/*#__PURE__*/_jsx(\"th\",{className:\"px-4 py-3 text-left text-xs font-medium text-gray-500 uppercase tracking-wider\",children:\"Assigned To\"}),/*#__PURE__*/_jsx(\"th\",{className:\"px-4 py-3 text-left text-xs font-medium text-gray-500 uppercase tracking-wider\",children:\"Created By\"}),/*#__PURE__*/_jsx(\"th\",{className:\"px-4 py-3 text-left text-xs font-medium text-gray-500 uppercase tracking-wider\",children:\"Actions\"})]})}),/*#__PURE__*/_jsx(\"tbody\",{className:\"divide-y divide-gray-200\",children:tickets.map(ticket=>{var _ticket$assignedAgent,_ticket$assignedAgent2;return/*#__PURE__*/_jsxs(\"tr\",{className:\"hover:bg-gray-50\",children:[/*#__PURE__*/_jsxs(\"td\",{className:\"px-4 py-3 text-sm text-gray-900\",children:[\"#\",ticket._id.slice(-6)]}),/*#__PURE__*/_jsx(\"td\",{className:\"px-4 py-3 text-sm text-gray-900 max-w-xs truncate\",children:ticket.title}),/*#__PURE__*/_jsx(\"td\",{className:\"px-4 py-3 text-sm\",children:/*#__PURE__*/_jsx(StatusBadge,{status:ticket.status})}),/*#__PURE__*/_jsx(\"td\",{className:\"px-4 py-3 text-sm\",children:/*#__PURE__*/_jsx(PriorityBadge,{priority:ticket.priority})}),/*#__PURE__*/_jsx(\"td\",{className:\"px-4 py-3 text-sm text-gray-900\",children:(isAdmin()||isAgent())&&agents.length>0?/*#__PURE__*/_jsxs(\"select\",{value:((_ticket$assignedAgent=ticket.assignedAgent)===null||_ticket$assignedAgent===void 0?void 0:_ticket$assignedAgent._id)||'',onChange:e=>handleAssign(ticket._id,e.target.value),className:\"text-sm border border-gray-300 rounded px-2 py-1 focus:ring-2 focus:ring-blue-500\",children:[/*#__PURE__*/_jsx(\"option\",{value:\"\",children:\"Unassigned\"}),agents.map(agent=>/*#__PURE__*/_jsx(\"option\",{value:agent._id,children:agent.username},agent._id))]}):((_ticket$assignedAgent2=ticket.assignedAgent)===null||_ticket$assignedAgent2===void 0?void 0:_ticket$assignedAgent2.username)||'Unassigned'}),/*#__PURE__*/_jsx(\"td\",{className:\"px-4 py-3 text-sm text-gray-900\",children:ticket.createdBy}),/*#__PURE__*/_jsx(\"td\",{className:\"px-4 py-3 text-sm\",children:/*#__PURE__*/_jsxs(\"div\",{className:\"flex gap-2\",children:[/*#__PURE__*/_jsx(\"button\",{onClick:()=>navigate(\"/tickets/\".concat(ticket._id)),className:\"p-1 text-blue-600 hover:bg-blue-50 rounded\",title:\"View details\",children:/*#__PURE__*/_jsx(Eye,{className:\"w-4 h-4\"})}),(isAdmin()||ticket.createdBy===(user===null||user===void 0?void 0:user.username))&&/*#__PURE__*/_jsx(\"button\",{onClick:()=>handleDelete(ticket._id,ticket.title),className:\"p-1 text-red-600 hover:bg-red-50 rounded\",title:\"Delete ticket\",children:/*#__PURE__*/_jsx(Trash2,{className:\"w-4 h-4\"})})]})})]},ticket._id);})})]})});};export default TicketTable;","map":{"version":3,"names":["React","useNavigate","Eye","Trash2","StatusBadge","PriorityBadge","EmptyState","useAuth","toast","jsx","_jsx","jsxs","_jsxs","TicketTable","_ref","tickets","onDelete","onAssign","agents","navigate","isAdmin","isAgent","user","handleDelete","id","title","window","confirm","concat","success","error","message","handleAssign","ticketId","agentId","length","icon","className","children","description","map","ticket","_ticket$assignedAgent","_ticket$assignedAgent2","_id","slice","status","priority","value","assignedAgent","onChange","e","target","agent","username","createdBy","onClick"],"sources":["/Users/adeeljaved/Documents/proxima_crm/frontend/src/components/dashboard/TicketTable.jsx"],"sourcesContent":["import React from 'react';\nimport { useNavigate } from 'react-router-dom';\nimport { Eye, Trash2 } from 'lucide-react';\nimport StatusBadge from '../common/StatusBadge';\nimport PriorityBadge from '../common/PriorityBadge';\nimport EmptyState from '../common/EmptyState';\nimport { useAuth } from '../../contexts/AuthContext';\nimport toast from 'react-hot-toast';\n\nconst TicketTable = ({ tickets, onDelete, onAssign, agents = [] }) => {\n  const navigate = useNavigate();\n  const { isAdmin, isAgent, user } = useAuth();\n\n  const handleDelete = async (id, title) => {\n    if (window.confirm(`Are you sure you want to delete \"${title}\"?`)) {\n      try {\n        await onDelete(id);\n        toast.success('Ticket deleted successfully');\n      } catch (error) {\n        toast.error(error.message || 'Failed to delete ticket');\n      }\n    }\n  };\n\n  const handleAssign = async (ticketId, agentId) => {\n    try {\n      await onAssign(ticketId, agentId);\n      toast.success('Ticket assigned successfully');\n    } catch (error) {\n      toast.error(error.message || 'Failed to assign ticket');\n    }\n  };\n\n  if (!tickets || tickets.length === 0) {\n    return (\n      <EmptyState\n        icon={() => <div className=\"text-6xl\">ðŸ“‹</div>}\n        title=\"No tickets found\"\n        description=\"There are no tickets to display.\"\n      />\n    );\n  }\n\n  return (\n    <div className=\"overflow-x-auto\">\n      <table className=\"min-w-full bg-white border border-gray-200 rounded-lg\">\n        <thead className=\"bg-gray-50\">\n          <tr>\n            <th className=\"px-4 py-3 text-left text-xs font-medium text-gray-500 uppercase tracking-wider\">\n              ID\n            </th>\n            <th className=\"px-4 py-3 text-left text-xs font-medium text-gray-500 uppercase tracking-wider\">\n              Title\n            </th>\n            <th className=\"px-4 py-3 text-left text-xs font-medium text-gray-500 uppercase tracking-wider\">\n              Status\n            </th>\n            <th className=\"px-4 py-3 text-left text-xs font-medium text-gray-500 uppercase tracking-wider\">\n              Priority\n            </th>\n            <th className=\"px-4 py-3 text-left text-xs font-medium text-gray-500 uppercase tracking-wider\">\n              Assigned To\n            </th>\n            <th className=\"px-4 py-3 text-left text-xs font-medium text-gray-500 uppercase tracking-wider\">\n              Created By\n            </th>\n            <th className=\"px-4 py-3 text-left text-xs font-medium text-gray-500 uppercase tracking-wider\">\n              Actions\n            </th>\n          </tr>\n        </thead>\n        <tbody className=\"divide-y divide-gray-200\">\n          {tickets.map((ticket) => (\n            <tr key={ticket._id} className=\"hover:bg-gray-50\">\n              <td className=\"px-4 py-3 text-sm text-gray-900\">\n                #{ticket._id.slice(-6)}\n              </td>\n              <td className=\"px-4 py-3 text-sm text-gray-900 max-w-xs truncate\">\n                {ticket.title}\n              </td>\n              <td className=\"px-4 py-3 text-sm\">\n                <StatusBadge status={ticket.status} />\n              </td>\n              <td className=\"px-4 py-3 text-sm\">\n                <PriorityBadge priority={ticket.priority} />\n              </td>\n              <td className=\"px-4 py-3 text-sm text-gray-900\">\n                {(isAdmin() || isAgent()) && agents.length > 0 ? (\n                  <select\n                    value={ticket.assignedAgent?._id || ''}\n                    onChange={(e) => handleAssign(ticket._id, e.target.value)}\n                    className=\"text-sm border border-gray-300 rounded px-2 py-1 focus:ring-2 focus:ring-blue-500\"\n                  >\n                    <option value=\"\">Unassigned</option>\n                    {agents.map((agent) => (\n                      <option key={agent._id} value={agent._id}>\n                        {agent.username}\n                      </option>\n                    ))}\n                  </select>\n                ) : (\n                  ticket.assignedAgent?.username || 'Unassigned'\n                )}\n              </td>\n              <td className=\"px-4 py-3 text-sm text-gray-900\">\n                {ticket.createdBy}\n              </td>\n              <td className=\"px-4 py-3 text-sm\">\n                <div className=\"flex gap-2\">\n                  <button\n                    onClick={() => navigate(`/tickets/${ticket._id}`)}\n                    className=\"p-1 text-blue-600 hover:bg-blue-50 rounded\"\n                    title=\"View details\"\n                  >\n                    <Eye className=\"w-4 h-4\" />\n                  </button>\n                  {(isAdmin() || ticket.createdBy === user?.username) && (\n                    <button\n                      onClick={() => handleDelete(ticket._id, ticket.title)}\n                      className=\"p-1 text-red-600 hover:bg-red-50 rounded\"\n                      title=\"Delete ticket\"\n                    >\n                      <Trash2 className=\"w-4 h-4\" />\n                    </button>\n                  )}\n                </div>\n              </td>\n            </tr>\n          ))}\n        </tbody>\n      </table>\n    </div>\n  );\n};\n\nexport default TicketTable;\n"],"mappings":"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","ignoreList":[]},"metadata":{},"sourceType":"module","externalDependencies":[]}