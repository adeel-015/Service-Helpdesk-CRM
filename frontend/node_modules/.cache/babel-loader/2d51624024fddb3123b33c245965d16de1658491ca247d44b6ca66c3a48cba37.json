{"ast":null,"code":"import _objectSpread from\"/Users/adeeljaved/Documents/proxima_crm/frontend/node_modules/@babel/runtime/helpers/esm/objectSpread2.js\";import React,{useEffect,useState}from\"react\";import ApiService from\"../services/api\";import LoadingSpinner from\"../components/common/LoadingSpinner\";import Modal from\"../components/common/Modal\";import toast from\"react-hot-toast\";import{jsx as _jsx,jsxs as _jsxs}from\"react/jsx-runtime\";const ProfilePage=()=>{const[loading,setLoading]=useState(true);const[editing,setEditing]=useState(false);const[form,setForm]=useState({username:\"\",email:\"\"});const[passwordModalOpen,setPasswordModalOpen]=useState(false);const[pwForm,setPwForm]=useState({oldPassword:\"\",newPassword:\"\"});useEffect(()=>{fetchProfile();},[]);const fetchProfile=async()=>{setLoading(true);try{const data=await ApiService.getProfile();setForm({username:data.username||\"\",email:data.email||\"\"});}catch(error){toast.error(\"Failed to load profile\");}finally{setLoading(false);}};const handleSave=async()=>{try{await ApiService.updateProfile(form);toast.success(\"Profile updated\");setEditing(false);fetchProfile();}catch(error){toast.error(error.message||\"Failed to update profile\");}};const handleChangePassword=async()=>{try{await ApiService.changePassword(pwForm);toast.success(\"Password changed\");setPasswordModalOpen(false);setPwForm({oldPassword:\"\",newPassword:\"\"});}catch(error){toast.error(error.message||\"Failed to change password\");}};if(loading){return/*#__PURE__*/_jsx(\"div\",{className:\"flex items-center justify-center h-64\",children:/*#__PURE__*/_jsx(LoadingSpinner,{size:\"lg\",text:\"Loading profile...\"})});}return/*#__PURE__*/_jsxs(\"div\",{className:\"space-y-6\",children:[/*#__PURE__*/_jsxs(\"div\",{className:\"flex items-center justify-between\",children:[/*#__PURE__*/_jsx(\"h1\",{className:\"text-3xl font-bold\",children:\"Profile\"}),/*#__PURE__*/_jsxs(\"div\",{className:\"flex gap-2\",children:[/*#__PURE__*/_jsx(\"button\",{onClick:()=>setEditing(s=>!s),className:\"px-3 py-2 border rounded\",children:editing?\"Cancel\":\"Edit\"}),/*#__PURE__*/_jsx(\"button\",{onClick:()=>setPasswordModalOpen(true),className:\"px-3 py-2 bg-blue-600 text-white rounded\",children:\"Change Password\"})]})]}),/*#__PURE__*/_jsx(\"div\",{className:\"bg-white rounded-lg shadow-md border border-gray-200 p-6 w-full max-w-2xl\",children:/*#__PURE__*/_jsxs(\"div\",{className:\"grid grid-cols-1 gap-4\",children:[/*#__PURE__*/_jsxs(\"label\",{className:\"flex flex-col\",children:[/*#__PURE__*/_jsx(\"span\",{className:\"text-sm text-gray-600\",children:\"Username\"}),/*#__PURE__*/_jsx(\"input\",{value:form.username,onChange:e=>setForm(_objectSpread(_objectSpread({},form),{},{username:e.target.value})),readOnly:!editing,className:\"mt-1 p-2 border rounded\"})]}),/*#__PURE__*/_jsxs(\"label\",{className:\"flex flex-col\",children:[/*#__PURE__*/_jsx(\"span\",{className:\"text-sm text-gray-600\",children:\"Email\"}),/*#__PURE__*/_jsx(\"input\",{value:form.email,onChange:e=>setForm(_objectSpread(_objectSpread({},form),{},{email:e.target.value})),readOnly:!editing,className:\"mt-1 p-2 border rounded\"})]}),editing&&/*#__PURE__*/_jsxs(\"div\",{className:\"flex gap-2 mt-2\",children:[/*#__PURE__*/_jsx(\"button\",{onClick:handleSave,className:\"px-4 py-2 bg-blue-600 text-white rounded\",children:\"Save\"}),/*#__PURE__*/_jsx(\"button\",{onClick:()=>setEditing(false),className:\"px-4 py-2 border rounded\",children:\"Cancel\"})]})]})}),/*#__PURE__*/_jsx(Modal,{isOpen:passwordModalOpen,onClose:()=>setPasswordModalOpen(false),title:\"Change Password\",children:/*#__PURE__*/_jsxs(\"div\",{className:\"space-y-4\",children:[/*#__PURE__*/_jsxs(\"label\",{className:\"flex flex-col\",children:[/*#__PURE__*/_jsx(\"span\",{className:\"text-sm text-gray-600\",children:\"Old Password\"}),/*#__PURE__*/_jsx(\"input\",{type:\"password\",value:pwForm.oldPassword,onChange:e=>setPwForm(_objectSpread(_objectSpread({},pwForm),{},{oldPassword:e.target.value})),className:\"mt-1 p-2 border rounded\"})]}),/*#__PURE__*/_jsxs(\"label\",{className:\"flex flex-col\",children:[/*#__PURE__*/_jsx(\"span\",{className:\"text-sm text-gray-600\",children:\"New Password\"}),/*#__PURE__*/_jsx(\"input\",{type:\"password\",value:pwForm.newPassword,onChange:e=>setPwForm(_objectSpread(_objectSpread({},pwForm),{},{newPassword:e.target.value})),className:\"mt-1 p-2 border rounded\"})]}),/*#__PURE__*/_jsxs(\"div\",{className:\"flex gap-2\",children:[/*#__PURE__*/_jsx(\"button\",{onClick:handleChangePassword,className:\"px-4 py-2 bg-blue-600 text-white rounded\",children:\"Change Password\"}),/*#__PURE__*/_jsx(\"button\",{onClick:()=>setPasswordModalOpen(false),className:\"px-4 py-2 border rounded\",children:\"Cancel\"})]})]})})]});};export default ProfilePage;","map":{"version":3,"names":["React","useEffect","useState","ApiService","LoadingSpinner","Modal","toast","jsx","_jsx","jsxs","_jsxs","ProfilePage","loading","setLoading","editing","setEditing","form","setForm","username","email","passwordModalOpen","setPasswordModalOpen","pwForm","setPwForm","oldPassword","newPassword","fetchProfile","data","getProfile","error","handleSave","updateProfile","success","message","handleChangePassword","changePassword","className","children","size","text","onClick","s","value","onChange","e","_objectSpread","target","readOnly","isOpen","onClose","title","type"],"sources":["/Users/adeeljaved/Documents/proxima_crm/frontend/src/pages/ProfilePage.jsx"],"sourcesContent":["import React, { useEffect, useState } from \"react\";\nimport ApiService from \"../services/api\";\nimport LoadingSpinner from \"../components/common/LoadingSpinner\";\nimport Modal from \"../components/common/Modal\";\nimport toast from \"react-hot-toast\";\n\nconst ProfilePage = () => {\n  const [loading, setLoading] = useState(true);\n  const [editing, setEditing] = useState(false);\n  const [form, setForm] = useState({ username: \"\", email: \"\" });\n  const [passwordModalOpen, setPasswordModalOpen] = useState(false);\n  const [pwForm, setPwForm] = useState({ oldPassword: \"\", newPassword: \"\" });\n\n  useEffect(() => {\n    fetchProfile();\n  }, []);\n\n  const fetchProfile = async () => {\n    setLoading(true);\n    try {\n      const data = await ApiService.getProfile();\n      setForm({ username: data.username || \"\", email: data.email || \"\" });\n    } catch (error) {\n      toast.error(\"Failed to load profile\");\n    } finally {\n      setLoading(false);\n    }\n  };\n\n  const handleSave = async () => {\n    try {\n      await ApiService.updateProfile(form);\n      toast.success(\"Profile updated\");\n      setEditing(false);\n      fetchProfile();\n    } catch (error) {\n      toast.error(error.message || \"Failed to update profile\");\n    }\n  };\n\n  const handleChangePassword = async () => {\n    try {\n      await ApiService.changePassword(pwForm);\n      toast.success(\"Password changed\");\n      setPasswordModalOpen(false);\n      setPwForm({ oldPassword: \"\", newPassword: \"\" });\n    } catch (error) {\n      toast.error(error.message || \"Failed to change password\");\n    }\n  };\n\n  if (loading) {\n    return (\n      <div className=\"flex items-center justify-center h-64\">\n        <LoadingSpinner size=\"lg\" text=\"Loading profile...\" />\n      </div>\n    );\n  }\n\n  return (\n    <div className=\"space-y-6\">\n      <div className=\"flex items-center justify-between\">\n        <h1 className=\"text-3xl font-bold\">Profile</h1>\n        <div className=\"flex gap-2\">\n          <button\n            onClick={() => setEditing((s) => !s)}\n            className=\"px-3 py-2 border rounded\"\n          >\n            {editing ? \"Cancel\" : \"Edit\"}\n          </button>\n          <button\n            onClick={() => setPasswordModalOpen(true)}\n            className=\"px-3 py-2 bg-blue-600 text-white rounded\"\n          >\n            Change Password\n          </button>\n        </div>\n      </div>\n\n      <div className=\"bg-white rounded-lg shadow-md border border-gray-200 p-6 w-full max-w-2xl\">\n        <div className=\"grid grid-cols-1 gap-4\">\n          <label className=\"flex flex-col\">\n            <span className=\"text-sm text-gray-600\">Username</span>\n            <input\n              value={form.username}\n              onChange={(e) => setForm({ ...form, username: e.target.value })}\n              readOnly={!editing}\n              className=\"mt-1 p-2 border rounded\"\n            />\n          </label>\n\n          <label className=\"flex flex-col\">\n            <span className=\"text-sm text-gray-600\">Email</span>\n            <input\n              value={form.email}\n              onChange={(e) => setForm({ ...form, email: e.target.value })}\n              readOnly={!editing}\n              className=\"mt-1 p-2 border rounded\"\n            />\n          </label>\n\n          {editing && (\n            <div className=\"flex gap-2 mt-2\">\n              <button\n                onClick={handleSave}\n                className=\"px-4 py-2 bg-blue-600 text-white rounded\"\n              >\n                Save\n              </button>\n              <button\n                onClick={() => setEditing(false)}\n                className=\"px-4 py-2 border rounded\"\n              >\n                Cancel\n              </button>\n            </div>\n          )}\n        </div>\n      </div>\n\n      <Modal\n        isOpen={passwordModalOpen}\n        onClose={() => setPasswordModalOpen(false)}\n        title=\"Change Password\"\n      >\n        <div className=\"space-y-4\">\n          <label className=\"flex flex-col\">\n            <span className=\"text-sm text-gray-600\">Old Password</span>\n            <input\n              type=\"password\"\n              value={pwForm.oldPassword}\n              onChange={(e) =>\n                setPwForm({ ...pwForm, oldPassword: e.target.value })\n              }\n              className=\"mt-1 p-2 border rounded\"\n            />\n          </label>\n          <label className=\"flex flex-col\">\n            <span className=\"text-sm text-gray-600\">New Password</span>\n            <input\n              type=\"password\"\n              value={pwForm.newPassword}\n              onChange={(e) =>\n                setPwForm({ ...pwForm, newPassword: e.target.value })\n              }\n              className=\"mt-1 p-2 border rounded\"\n            />\n          </label>\n          <div className=\"flex gap-2\">\n            <button\n              onClick={handleChangePassword}\n              className=\"px-4 py-2 bg-blue-600 text-white rounded\"\n            >\n              Change Password\n            </button>\n            <button\n              onClick={() => setPasswordModalOpen(false)}\n              className=\"px-4 py-2 border rounded\"\n            >\n              Cancel\n            </button>\n          </div>\n        </div>\n      </Modal>\n    </div>\n  );\n};\n\nexport default ProfilePage;\n"],"mappings":"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","ignoreList":[]},"metadata":{},"sourceType":"module","externalDependencies":[]}